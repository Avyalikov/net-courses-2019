1.1.1

select OrderID, ShippedDate, ShipVia
from Orders
where ShippedDate >= '1998-05-06' and ShipVia >= 2

1.1.2

select OrderID, 
case when ShippedDate is null then 'Not Shipped' else cast(ShippedDate as varchar) end as ShippedDate
from Orders

1.1.3

select OrderID as "Order Number", 
case when ShippedDate is null then 'Not Shipped' else cast(ShippedDate as varchar) end as "Shipped Date"
from Orders
where ShippedDate > '1998-05-06' or ShippedDate is null

1.2.1

select substring(ContactName,0,charindex(' ',ContactName)) as ContactName, Country
from Customers
where Country in ('USA', 'Canada')
order by substring(ContactName,0,charindex(' ',ContactName)), Country

1.2.2

select substring(ContactName,0,charindex(' ',ContactName)) as ContactName, Country
from Customers
where Country not in ('USA', 'Canada')
order by substring(ContactName,0,charindex(' ',ContactName)), Country

1.2.3

select distinct Country
from Customers
where CustomerID is not null
order by Country desc

1.3.1

select distinct OrderID
from "Order Details"
where Quantity between 3 and 10

1.3.2

select CustomerID, Country
from Customers
where Left(Country,1) between 'b' and 'g'
order by Country

1.3.3

select CustomerID
from Customers
where Left(Country,1) >= 'b' and Left(Country,1) <= 'g'

--alternative

select CustomerID, Country
from Customers
where Country Like '[b-g]%'

1.4

select ProductName
from Products
where ProductName like '%cho_olade%'

2.1.1

select sum(UnitPrice*Quantity) as Totals
from "Order Details"

2.1.2

select count(ShippedDate) as Count
from Orders

2.1.3

select count(distinct CustomerID) as "Count"
from Orders

2.2.1
select Year(OrderDate) as "Year", Count(distinct OrderID) as Total
from Orders
group by Year(OrderDate)

select count(OrderID)
from Orders

2.2.2

select
(select Employees.FirstName + ' ' + Employees.LastName
from Employees
where Employees.EmployeeID = Orders.EmployeeID) as "Seller", count(orderID) as "Amount"
from Orders, Employees
group by Orders.EmployeeID
order by Amount desc

2.2.3

select
(select Employees.FirstName + ' ' + Employees.LastName
from Employees
where Employees.EmployeeID = Orders.EmployeeID) as "Employee", 
(select Customers.ContactName
from Customers
where Customers.CustomerID = Orders.CustomerID) as "Customer", count(OrderID)
from orders
where Year(OrderDate) = 1998
group by EmployeeID, CustomerID
order by EmployeeID, CustomerID

2.2.4

select Employees.FirstName + ' ' + Employees.LastName as "Employee", Customers.ContactName as "Customers"
from Employees, Customers
where Employees.City = Customers.City

2.2.5

select ContactName
from Customers
where Customers.City in  
(select City
from Customers
group by City
having count(ContactName)>1)

2.2.6

select e1.FirstName + ' ' + e1.LastName as "Employee",
(select e2.FirstName + ' ' + e2.LastName
from Employees as e2
where e1.ReportsTo = e2.EmployeeID) as "Manager"
from Employees as e1

2.3.1

select distinct FirstName + ' ' + LastName as "Employee"
from Employees
join EmployeeTerritories on Employees.EmployeeID = EmployeeTerritories.EmployeeID
join Territories on EmployeeTerritories.TerritoryID = Territories.TerritoryID
join Region on Territories.RegionID = Region.RegionID
where Region.RegionDescription = 'Western'

2.3.2

select ContactName, count(OrderDate) as "Number of orders"
from Customers
left outer join Orders on Customers.CustomerID = Orders.CustomerID
group by ContactName
order by "Number of orders" asc

2.4.1

select CompanyName
from Suppliers
where supplierID in
(select SupplierID
from Products
where UnitsInStock = 0)

2.4.2

select FirstName + ' ' + LastName as "Employee"
from Employees
where EmployeeID in
(select EmployeeID
from Orders
group by EmployeeID
having count(OrderDate)>150)

2.4.3

select CompanyName
from Customers
where not exists(
(SELECT CustomerID
from Orders
where Orders.CustomerID = Customers.CustomerID))

--check

select Customers.CompanyName
from Customers
left outer join Orders
on Customers.CustomerID = Orders.CustomerID
where OrderDate is null
order by OrderDate
